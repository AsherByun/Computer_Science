# 트랜잭션

## 트랜잭션(Transaction) 이란?

데이터베이스의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위

참고 → 작업의 단위는 질의어 한문장이 아니다. 트랜잭션은 설계에 따라 다르다.

---

## 특징

1. 데이터베이스 시스템에서 병행 제어 및 회복 작업 시 처리되는 작업의 논리적 단위이다.
2. 사용자가 시스템에 대한 서비스 요구 시 시스템이 응답하기 위한 상태 변환 과정의 작업단위이다.
3. 하나의 트랜잭션은 Commit 되거나 Rollback 된다

---

## 성질 (ACID)

- Atomicity(원자성)
    1. 트랜잭션의 연산은 데이터베이스에 모두 반영되든지 아니면 전혀 반영되지 않아야 한다.
    2. 트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수행되지 않고 어느 하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 한다.

- Consistency(일관성)
    1. 트랜잭션이 그 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태로 변환한다.
    2. 시스템이 가지고 있는 고정 요소는 트랜잭션 수행 전과 트랜잭션 수행 완료 후의 상태가 같아야 한다.

- Isolation(독립성, 격리성)
    1. 둘 이상의 트랜잭션이 동시에 병행 실행되는 경우 어느 하나의 트랜잭션 실행중에 다른 트랜잭션의 연산이 끼어들 수 없다.
    2. 수행중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.

- Durability(지속성)
    1. 성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반영되어야 한다.

---

## 트랜잭션 연산

- Commit 연산
    1. 하나의 논리적 단위(트랜잭션)에 대한 작업이 성공적으로 끝났고 데이터베이스가 다시 일관된 상태에 있을 때, 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산
- Rollback 연산
    1. 하나의 트랜잭션 처리가 비정상적으로 종료되어 데이터베이스의 일관성을 깨트렸을 때, 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소(Undo)하는 연산
    2. Rollback 시에는 해당 트랜잭션을 재시작하거나 폐기한다.

---

## 트랜잭션 상태

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/343808b9-3bf5-484f-bcfc-97fdf417d4b2/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/343808b9-3bf5-484f-bcfc-97fdf417d4b2/Untitled.png)

- 활동(Active) : 실행중
- 실패(Failed) : 오류가 발생하여 중단
- 철회(Aborted) : 비정상적으로 종료되어 Rollback 연산을 수행
- 부분 완료(Partially Committed) : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전의 상태
- 완료(Committed) : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후
